λ kubectl get pods
NAME                          READY     STATUS    RESTARTS   AGE
helloworld-controller-nvmfs   1/1       Running   1          17h
helloworld-controller-plvj8   1/1       Running   1          17h
Dell lap@Dell ~
λ kubectl get rc
NAME                    DESIRED   CURRENT   READY     AGE
helloworld-controller   2         2         2         17h
Dell lap@Dell ~
λ kubectl delete rc helloworld-controller
replicationcontroller "helloworld-controller" deleted
Dell lap@Dell ~
λ cd docker-workshop/jun10/k8s
bash: cd: docker-workshop/jun10/k8s: No such file or directory
Dell lap@Dell ~
λ cd docker-workshop/jun10/ora-jun10-dock-kube/k8s/
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ git status
On branch master
Your branch is up to date with 'origin/master'.

Changes not staged for commit:
  (use "git add <file>..." to update what will be committed)
  (use "git checkout -- <file>..." to discard changes in working directory)

        modified:   dep/dep-helloworld.yml

no changes added to commit (use "git add" and/or "git commit -a")
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ git commit -a -m"some changes"
[master ac6954f] some changes
 1 file changed, 3 insertions(+), 3 deletions(-)
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ git push
fatal: HttpRequestException encountered.
   An error occurred while sending the request.
Username for 'https://github.com': adityasp
remote: Invalid username or password.
fatal: Authentication failed for 'https://github.com/AdityaSP/ora-jun10-dock-kube/'
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ git push https://adityasp@github.com/AdityaSP/ora-jun10-dock-kube
fatal: HttpRequestException encountered.
   An error occurred while sending the request.
remote: Invalid username or password.
fatal: Authentication failed for 'https://adityasp@github.com/AdityaSP/ora-jun10-dock-kube/'
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ git push https://adityasp@github.com/AdityaSP/ora-jun10-dock-kube
fatal: HttpRequestException encountered.
   An error occurred while sending the request.
remote: Invalid username or password.
fatal: Authentication failed for 'https://adityasp@github.com/AdityaSP/ora-jun10-dock-kube/'
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl get pods
No resources found.
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl apply -f dep/dep-helloworld.yml
deployment "helloworld-dep" created
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl get deploy
NAME             DESIRED   CURRENT   UP-TO-DATE   AVAILABLE   AGE
helloworld-dep   2         2         2            2           25s
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl describe deploy helloworld-dep
Name:                   helloworld-dep
Namespace:              default
CreationTimestamp:      Thu, 13 Jun 2019 09:49:35 +0530
Labels:                 app=helloworld
Annotations:            deployment.kubernetes.io/revision=1
                        kubectl.kubernetes.io/last-applied-configuration={"apiVersion":"extensions/v1beta1","kind":"Deployment","metadata":{"annotations":{},"name":"helloworld-dep","namespace":"default"},"spec":{"replicas":2...
Selector:               app=helloworld
Replicas:               2 desired | 2 updated | 2 total | 2 available | 0 unavailable
StrategyType:           RollingUpdate
MinReadySeconds:        0
RollingUpdateStrategy:  1 max unavailable, 1 max surge
Pod Template:
  Labels:  app=helloworld
  Containers:
   web:
    Image:        nginx
    Port:         80/TCP
    Environment:  <none>
    Mounts:       <none>
  Volumes:        <none>
Conditions:
  Type           Status  Reason
  ----           ------  ------
  Available      True    MinimumReplicasAvailable
OldReplicaSets:  <none>
NewReplicaSet:   helloworld-dep-765746cb75 (2/2 replicas created)
Events:
  Type    Reason             Age   From                   Message
  ----    ------             ----  ----                   -------
  Normal  ScalingReplicaSet  47s   deployment-controller  Scaled up replica set helloworld-dep-765746cb75 to 2
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl get rs
NAME                        DESIRED   CURRENT   READY     AGE
helloworld-dep-765746cb75   2         2         2         1m
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl get rc
No resources found.
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl describe rs helloworld-dep-765746cb75
Name:           helloworld-dep-765746cb75
Namespace:      default
Selector:       app=helloworld,pod-template-hash=3213027631
Labels:         app=helloworld
                pod-template-hash=3213027631
Annotations:    deployment.kubernetes.io/desired-replicas=2
                deployment.kubernetes.io/max-replicas=3
                deployment.kubernetes.io/revision=1
Controlled By:  Deployment/helloworld-dep
Replicas:       2 current / 2 desired
Pods Status:    2 Running / 0 Waiting / 0 Succeeded / 0 Failed
Pod Template:
  Labels:  app=helloworld
           pod-template-hash=3213027631
  Containers:
   web:
    Image:        nginx
    Port:         80/TCP
    Environment:  <none>
    Mounts:       <none>
  Volumes:        <none>
Events:
  Type    Reason            Age   From                   Message
  ----    ------            ----  ----                   -------
  Normal  SuccessfulCreate  2m    replicaset-controller  Created pod: helloworld-dep-765746cb75-9skkm
  Normal  SuccessfulCreate  2m    replicaset-controller  Created pod: helloworld-dep-765746cb75-n8qbq
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl get pods
NAME                              READY     STATUS    RESTARTS   AGE
helloworld-dep-765746cb75-9skkm   1/1       Running   0          2m
helloworld-dep-765746cb75-n8qbq   1/1       Running   0          2m
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl get deploy
NAME             DESIRED   CURRENT   UP-TO-DATE   AVAILABLE   AGE
helloworld-dep   2         2         2            2           3m
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl get rs
NAME                        DESIRED   CURRENT   READY     AGE
helloworld-dep-765746cb75   2         2         2         3m
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl get pod
NAME                              READY     STATUS    RESTARTS   AGE
helloworld-dep-765746cb75-9skkm   1/1       Running   0          3m
helloworld-dep-765746cb75-n8qbq   1/1       Running   0          3m
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl get pod --show-labels
NAME                              READY     STATUS    RESTARTS   AGE       LABELS
helloworld-dep-765746cb75-9skkm   1/1       Running   0          4m        app=helloworld,pod-template-hash=3213027631
helloworld-dep-765746cb75-n8qbq   1/1       Running   0          4m        app=helloworld,pod-template-hash=3213027631
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl scale deploy helloworld-dep --replicas 5
deployment "helloworld-dep" scaled
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl get deploy
NAME             DESIRED   CURRENT   UP-TO-DATE   AVAILABLE   AGE
helloworld-dep   5         5         5            3           7m
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl get rs
NAME                        DESIRED   CURRENT   READY     AGE
helloworld-dep-765746cb75   5         5         4         7m
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl get pods
NAME                              READY     STATUS    RESTARTS   AGE
helloworld-dep-765746cb75-94l4g   1/1       Running   0          30s
helloworld-dep-765746cb75-9skkm   1/1       Running   0          8m
helloworld-dep-765746cb75-fjqfj   1/1       Running   0          30s
helloworld-dep-765746cb75-n8qbq   1/1       Running   0          8m
helloworld-dep-765746cb75-xgvf7   1/1       Running   0          30s
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl apply -f dep/dep-helloworld.yml
deployment "helloworld-dep" configured
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl get pods
NAME                              READY     STATUS        RESTARTS   AGE
helloworld-dep-765746cb75-94l4g   0/1       Terminating   0          1m
helloworld-dep-765746cb75-9skkm   1/1       Running       0          8m
helloworld-dep-765746cb75-fjqfj   1/1       Running       0          1m
helloworld-dep-765746cb75-n8qbq   1/1       Running       0          8m
helloworld-dep-765746cb75-xgvf7   0/1       Terminating   0          1m
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl rollout history deploy helloworld-dep
deployments "helloworld-dep"
REVISION  CHANGE-CAUSE
1         <none>

Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl rollout history deploy helloworld-dep --revision 1
deployments "helloworld-dep" with revision #1
Pod Template:
  Labels:       app=helloworld
        pod-template-hash=3213027631
  Containers:
   web:
    Image:      nginx
    Port:       80/TCP
    Environment:        <none>
    Mounts:     <none>
  Volumes:      <none>

Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl scale deployment helloworld-dep --replicas 10
deployment "helloworld-dep" scaled
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl rollout status deployment "helloworld-dep"
deployment "helloworld-dep" successfully rolled out
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl get pods
NAME                              READY     STATUS    RESTARTS   AGE
helloworld-dep-765746cb75-6gbnn   1/1       Running   0          1m
helloworld-dep-765746cb75-9skkm   1/1       Running   0          15m
helloworld-dep-765746cb75-b6lrb   1/1       Running   0          1m
helloworld-dep-765746cb75-btq5b   1/1       Running   0          1m
helloworld-dep-765746cb75-fjqfj   1/1       Running   0          7m
helloworld-dep-765746cb75-j8xsw   1/1       Running   0          1m
helloworld-dep-765746cb75-n8qbq   1/1       Running   0          15m
helloworld-dep-765746cb75-vlj7l   1/1       Running   0          1m
helloworld-dep-765746cb75-wkkqk   1/1       Running   0          1m
helloworld-dep-765746cb75-zpj85   1/1       Running   0          1m
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl describe pod helloworld-dep-765746cb75-6gbnn | grep Image
    Image:          nginx
    Image ID:       docker-pullable://nginx@sha256:bdbf36b7f1f77ffe7bd2a32e59235dff6ecf131e3b6b5b96061c652f30685f3a
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl set image deploy helloworld-dep web=nginx:alpine
deployment "helloworld-dep" image updated
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl rollout status deployment "helloworld-dep"
Waiting for rollout to finish: 2 out of 10 new replicas have been updated...
Waiting for rollout to finish: 2 out of 10 new replicas have been updated...
Waiting for rollout to finish: 2 out of 10 new replicas have been updated...
Waiting for rollout to finish: 3 out of 10 new replicas have been updated...
Waiting for rollout to finish: 3 out of 10 new replicas have been updated...
Waiting for rollout to finish: 3 out of 10 new replicas have been updated...
Waiting for rollout to finish: 3 out of 10 new replicas have been updated...
Waiting for rollout to finish: 4 out of 10 new replicas have been updated...
Waiting for rollout to finish: 4 out of 10 new replicas have been updated...
Waiting for rollout to finish: 4 out of 10 new replicas have been updated...
Waiting for rollout to finish: 4 out of 10 new replicas have been updated...
Waiting for rollout to finish: 4 out of 10 new replicas have been updated...
Waiting for rollout to finish: 5 out of 10 new replicas have been updated...
Waiting for rollout to finish: 5 out of 10 new replicas have been updated...
Waiting for rollout to finish: 5 out of 10 new replicas have been updated...
Waiting for rollout to finish: 5 out of 10 new replicas have been updated...
Waiting for rollout to finish: 5 out of 10 new replicas have been updated...
Waiting for rollout to finish: 6 out of 10 new replicas have been updated...
Waiting for rollout to finish: 6 out of 10 new replicas have been updated...
Waiting for rollout to finish: 6 out of 10 new replicas have been updated...
Waiting for rollout to finish: 6 out of 10 new replicas have been updated...
Waiting for rollout to finish: 7 out of 10 new replicas have been updated...
Waiting for rollout to finish: 7 out of 10 new replicas have been updated...
Waiting for rollout to finish: 7 out of 10 new replicas have been updated...
Waiting for rollout to finish: 7 out of 10 new replicas have been updated...
Waiting for rollout to finish: 8 out of 10 new replicas have been updated...
Waiting for rollout to finish: 8 out of 10 new replicas have been updated...
Waiting for rollout to finish: 8 out of 10 new replicas have been updated...
Waiting for rollout to finish: 8 out of 10 new replicas have been updated...
Waiting for rollout to finish: 9 out of 10 new replicas have been updated...
Waiting for rollout to finish: 9 out of 10 new replicas have been updated...
Waiting for rollout to finish: 9 out of 10 new replicas have been updated...
Waiting for rollout to finish: 9 out of 10 new replicas have been updated...
Waiting for rollout to finish: 1 old replicas are pending termination...
Waiting for rollout to finish: 1 old replicas are pending termination...
Waiting for rollout to finish: 1 old replicas are pending termination...
Waiting for rollout to finish: 9 of 10 updated replicas are available...
deployment "helloworld-dep" successfully rolled out
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl rollout history deploy helloworld-dep
deployments "helloworld-dep"
REVISION  CHANGE-CAUSE
1         <none>
2         <none>

Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl rollout history deploy helloworld-dep --revision 1
deployments "helloworld-dep" with revision #1
Pod Template:
  Labels:       app=helloworld
        pod-template-hash=3213027631
  Containers:
   web:
    Image:      nginx
    Port:       80/TCP
    Environment:        <none>
    Mounts:     <none>
  Volumes:      <none>

Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl rollout history deploy helloworld-dep --revision 2
deployments "helloworld-dep" with revision #2
Pod Template:
  Labels:       app=helloworld
        pod-template-hash=3843324994
  Containers:
   web:
    Image:      nginx:alpine
    Port:       80/TCP
    Environment:        <none>
    Mounts:     <none>
  Volumes:      <none>

Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ #kubectl rollout undo deploy helloworld-dep --to-revision 1
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl get pods
NAME                              READY     STATUS    RESTARTS   AGE
helloworld-dep-7d87768ff8-6pcdn   1/1       Running   0          3m
helloworld-dep-7d87768ff8-7hcfz   1/1       Running   0          2m
helloworld-dep-7d87768ff8-c4s5p   1/1       Running   0          2m
helloworld-dep-7d87768ff8-chcpn   1/1       Running   0          3m
helloworld-dep-7d87768ff8-fdkk7   1/1       Running   0          2m
helloworld-dep-7d87768ff8-s85l6   1/1       Running   0          2m
helloworld-dep-7d87768ff8-vkdhd   1/1       Running   0          3m
helloworld-dep-7d87768ff8-w8s9r   1/1       Running   0          2m
helloworld-dep-7d87768ff8-wtbqr   1/1       Running   0          2m
helloworld-dep-7d87768ff8-zx7mp   1/1       Running   0          3m
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl describe pod helloworld-dep-7d87768ff8-6pcdn | grep Image
    Image:          nginx:alpine
    Image ID:       docker-pullable://nginx@sha256:366c39a589f69a893368d942d9d323893025e8c27a523657ba3a2119dfc66057
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl rollout undo deploy helloworld-dep --to-revision 1
deployment "helloworld-dep"
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl rollout history deploy helloworld-dep
deployments "helloworld-dep"
REVISION  CHANGE-CAUSE
2         <none>
3         <none>

Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl rollout history deploy helloworld-dep --to-revision 2
Error: unknown flag: --to-revision


Examples:
  # View the rollout history of a deployment
  kubectl rollout history deployment/abc

  # View the details of daemonset revision 3
  kubectl rollout history daemonset/abc --revision=3

Options:
  -f, --filename=[]: Filename, directory, or URL to files identifying the resource to get from a server.
  -R, --recursive=false: Process the directory used in -f, --filename recursively. Useful when you want to manage related manifests organized within the same directory.
      --revision=0: See the details, including podTemplate of the revision specified

Usage:
  kubectl rollout history (TYPE NAME | TYPE/NAME) [flags] [options]

Use "kubectl options" for a list of global command-line options (applies to all commands).

error: unknown flag: --to-revision
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl rollout history deploy helloworld-dep --revision 2
deployments "helloworld-dep" with revision #2
Pod Template:
  Labels:       app=helloworld
        pod-template-hash=3843324994
  Containers:
   web:
    Image:      nginx:alpine
    Port:       80/TCP
    Environment:        <none>
    Mounts:     <none>
  Volumes:      <none>

Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl rollout history deploy helloworld-dep --revision 3
deployments "helloworld-dep" with revision #3
Pod Template:
  Labels:       app=helloworld
        pod-template-hash=3213027631
  Containers:
   web:
    Image:      nginx
    Port:       80/TCP
    Environment:        <none>
    Mounts:     <none>
  Volumes:      <none>

Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl rollout history deploy helloworld-dep
deployments "helloworld-dep"
REVISION  CHANGE-CAUSE
2         <none>
3         <none>

Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl rollout history deploy helloworld-dep --revision 2
deployments "helloworld-dep" with revision #2
Pod Template:
  Labels:       app=helloworld
        pod-template-hash=3843324994
  Containers:
   web:
    Image:      nginx:alpine
    Port:       80/TCP
    Environment:        <none>
    Mounts:     <none>
  Volumes:      <none>

Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl rollout history deploy helloworld-dep
deployments "helloworld-dep"
REVISION  CHANGE-CAUSE
2         <none>
3         <none>

Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl rollout undo deploy helloworld-dep --to-revision 2
deployment "helloworld-dep"
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl rollout history deploy helloworld-dep
deployments "helloworld-dep"
REVISION  CHANGE-CAUSE
3         <none>
4         <none>

Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ


-----------------------------------------------------------------------

Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl scale deployment helloworld-dep --replicas 1
deployment "helloworld-dep" scaled
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl get pods
NAME                              READY     STATUS    RESTARTS   AGE
helloworld-dep-79fdc576b9-gzkhl   1/1       Running   0          25m
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl get pods -o wide
NAME                              READY     STATUS    RESTARTS   AGE       IP           NODE
helloworld-dep-79fdc576b9-gzkhl   1/1       Running   0          25m       172.17.0.9   minikube

Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl apply -f service/svc-helloworld.yml
service "hw-svc" created
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl describe svc hw-svc
Name:                     hw-svc
Namespace:                default
Labels:                   <none>
Annotations:              kubectl.kubernetes.io/last-applied-configuration={"apiVersion":"v1","kind":"Service","metadata":{"annotations":{},"name":"hw-svc","namespace":"default"},"spec":{"ports":[{"nodePort":31001,"port":8888,...
Selector:                 app=helloworld
Type:                     NodePort
IP:                       10.98.220.82
Port:                     <unset>  8888/TCP
TargetPort:               nginxport/TCP
NodePort:                 <unset>  31001/TCP
Endpoints:                172.17.0.9:80
Session Affinity:         None
External Traffic Policy:  Cluster
Events:                   <none>
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl get pods -o wide
NAME                              READY     STATUS    RESTARTS   AGE       IP           NODE
helloworld-dep-79fdc576b9-gzkhl   1/1       Running   0          30m       172.17.0.9   minikube

Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl get pods -o wide --show-labels
NAME                              READY     STATUS    RESTARTS   AGE       IP           NODE
   LABELS
helloworld-dep-79fdc576b9-gzkhl   1/1       Running   0          30m       172.17.0.9   minikube
   app=helloworld,pod-template-hash=3598713265
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ



---------------------------------------------------------------------------------------------



Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl describe svc hw-svc
Name:                     hw-svc
Namespace:                default
Labels:                   <none>
Annotations:              kubectl.kubernetes.io/last-applied-configuration={"apiVersion":"v1","kind":"Service","metadata":{"annotations":{},"name":"hw-svc","namespace":"default"},"spec":{"ports":[{"nodePort":31001,"port":8888,...
Selector:                 app=helloworld
Type:                     NodePort
IP:                       10.98.220.82
Port:                     <unset>  8888/TCP
TargetPort:               nginxport/TCP
NodePort:                 <unset>  31001/TCP
Endpoints:                172.17.0.9:80
Session Affinity:         None
External Traffic Policy:  Cluster
Events:                   <none>
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl get pods
NAME                              READY     STATUS    RESTARTS   AGE
helloworld-dep-79fdc576b9-gzkhl   1/1       Running   0          1h
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl scale deployment helloworld-dep --replicas 2
deployment "helloworld-dep" scaled
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl get pods
NAME                              READY     STATUS    RESTARTS   AGE
helloworld-dep-79fdc576b9-8vvt4   1/1       Running   0          6s
helloworld-dep-79fdc576b9-gzkhl   1/1       Running   0          1h
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl describe svc hw-svc
Name:                     hw-svc
Namespace:                default
Labels:                   <none>
Annotations:              kubectl.kubernetes.io/last-applied-configuration={"apiVersion":"v1","kind":"Service","metadata":{"annotations":{},"name":"hw-svc","namespace":"default"},"spec":{"ports":[{"nodePort":31001,"port":8888,...
Selector:                 app=helloworld
Type:                     NodePort
IP:                       10.98.220.82
Port:                     <unset>  8888/TCP
TargetPort:               nginxport/TCP
NodePort:                 <unset>  31001/TCP
Endpoints:                172.17.0.13:80,172.17.0.9:80
Session Affinity:         None
External Traffic Policy:  Cluster
Events:                   <none>
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl get pods -o wide
NAME                              READY     STATUS    RESTARTS   AGE       IP            NODE
helloworld-dep-79fdc576b9-8vvt4   1/1       Running   0          57s       172.17.0.13   minikube
helloworld-dep-79fdc576b9-gzkhl   1/1       Running   0          1h        172.17.0.9    minikube
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl set image deploy helloworld-dep web=nginx:alpine
deployment "helloworld-dep" image updated
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl get pods -o wide
NAME                              READY     STATUS    RESTARTS   AGE       IP            NODE
helloworld-dep-5cdb68cc76-jwvz8   1/1       Running   0          16s       172.17.0.13   minikube
helloworld-dep-5cdb68cc76-z548q   1/1       Running   0          16s       172.17.0.16   minikube
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl describe svc hw-svc
Name:                     hw-svc
Namespace:                default
Labels:                   <none>
Annotations:              kubectl.kubernetes.io/last-applied-configuration={"apiVersion":"v1","kind":"Service","metadata":{"annotations":{},"name":"hw-svc","namespace":"default"},"spec":{"ports":[{"nodePort":31001,"port":8888,...
Selector:                 app=helloworld
Type:                     NodePort
IP:                       10.98.220.82
Port:                     <unset>  8888/TCP
TargetPort:               nginxport/TCP
NodePort:                 <unset>  31001/TCP
Endpoints:                172.17.0.13:80,172.17.0.16:80
Session Affinity:         None
External Traffic Policy:  Cluster
Events:                   <none>
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ curl 192.168.99.137:31001
<!DOCTYPE html>
<html>
<head>
<title>Welcome to nginx!</title>
<style>
    body {
        width: 35em;
        margin: 0 auto;
        font-family: Tahoma, Verdana, Arial, sans-serif;
    }
</style>
</head>
<body>
<h1>Welcome to nginx!</h1>
<p>If you see this page, the nginx web server is successfully installed and
working. Further configuration is required.</p>

<p>For online documentation and support please refer to
<a href="http://nginx.org/">nginx.org</a>.<br/>
Commercial support is available at
<a href="http://nginx.com/">nginx.com</a>.</p>

<p><em>Thank you for using nginx.</em></p>
</body>
</html>
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl set image deploy helloworld-dep web=aa
deployment "helloworld-dep" image updated
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl get pods -o wide
NAME                              READY     STATUS    RESTARTS   AGE       IP            NODE
helloworld-dep-79fdc576b9-4rlhh   1/1       Running   0          26s       172.17.0.9    minikube
helloworld-dep-79fdc576b9-qrrj9   1/1       Running   0          26s       172.17.0.13   minikube
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ curl 192.168.99.137:31001
<html><body><h1>It works!</h1></body></html>
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ curl 192.168.99.137:31001
<html><body><h1>It works!</h1></body></html>
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl get pods -o wide
NAME                              READY     STATUS    RESTARTS   AGE       IP            NODE
helloworld-dep-79fdc576b9-4rlhh   1/1       Running   0          3m        172.17.0.9    minikube
helloworld-dep-79fdc576b9-qrrj9   1/1       Running   0          3m        172.17.0.13   minikube
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ #docker container exec -it <container id> sh
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl exec -it helloworld-dep-79fdc576b9-4rlhh -- sh
/ # ps
PID   USER     TIME  COMMAND
    1 root      0:00 httpd -D FOREGROUND
    6 apache    0:00 httpd -D FOREGROUND
    7 apache    0:00 httpd -D FOREGROUND
    8 apache    0:00 httpd -D FOREGROUND
    9 apache    0:00 httpd -D FOREGROUND
   10 apache    0:00 httpd -D FOREGROUND
   11 root      0:00 sh
   16 root      0:00 ps
/ # curl
sh: curl: not found
/ # apk add curl
fetch http://dl-cdn.alpinelinux.org/alpine/v3.9/main/x86_64/APKINDEX.tar.gz
fetch http://dl-cdn.alpinelinux.org/alpine/v3.9/community/x86_64/APKINDEX.tar.gz
(1/5) Installing ca-certificates (20190108-r0)
(2/5) Installing nghttp2-libs (1.35.1-r0)
(3/5) Installing libssh2 (1.8.2-r0)
(4/5) Installing libcurl (7.64.0-r2)
(5/5) Installing curl (7.64.0-r2)
Executing busybox-1.29.3-r10.trigger
Executing ca-certificates-20190108-r0.trigger
OK: 11 MiB in 25 packages
/ # curl localhost:80
<html><body><h1>It works!</h1></body></html>
/ # curl 172.17.0.13:80
<html><body><h1>It works!</h1></body></html>
/ # curl 192.168.99.137:31001
<html><body><h1>It works!</h1></body></html>
/ # curl 10.98.220.82:8888
^C
/ # curl 10.98.220.82:8888
<html><body><h1>It works!</h1></body></html>
/ # curl hw-svc:8888
<html><body><h1>It works!</h1></body></html>
/ # cat /etc/resolv.conf
nameserver 10.96.0.10
search default.svc.cluster.local svc.cluster.local cluster.local
options ndots:5
/ # nslookup hw-svc
nslookup: can't resolve '(null)': Name does not resolve

Name:      hw-svc
Address 1: 10.98.220.82 hw-svc.default.svc.cluster.local
/ # curl hw-svc.default.svc.cluster.local:8888
<html><body><h1>It works!</h1></body></html>
/ # ^C
/ # exit
command terminated with exit code 130
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl get svc
NAME         TYPE        CLUSTER-IP     EXTERNAL-IP   PORT(S)          AGE
hw-svc       NodePort    10.98.220.82   <none>        8888:31001/TCP   1h
kubernetes   ClusterIP   10.96.0.1      <none>        443/TCP          183d
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl get ns
NAME          STATUS    AGE
default       Active    183d
kube-public   Active    183d
kube-system   Active    183d
monitoring    Active    181d
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl get svc -n kube-system
NAME                   TYPE        CLUSTER-IP       EXTERNAL-IP   PORT(S)             AGE
default-http-backend   NodePort    10.103.225.247   <none>        80:30001/TCP        183d
heapster               ClusterIP   10.105.175.217   <none>        80/TCP              183d
kube-dns               ClusterIP   10.96.0.10       <none>        53/UDP,53/TCP       183d
kubernetes-dashboard   NodePort    10.103.11.130    <none>        80:30000/TCP        183d
metrics-server         ClusterIP   10.109.22.160    <none>        443/TCP             181d
monitoring-grafana     NodePort    10.109.41.42     <none>        80:30002/TCP        183d
monitoring-influxdb    ClusterIP   10.103.96.251    <none>        8083/TCP,8086/TCP   183d
tiller-deploy          ClusterIP   10.96.170.66     <none>        44134/TCP           118d
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl describe svc kube-dns -n kube-system
Name:              kube-dns
Namespace:         kube-system
Labels:            addonmanager.kubernetes.io/mode=Reconcile
                   k8s-app=kube-dns
                   kubernetes.io/name=KubeDNS
Annotations:       kubectl.kubernetes.io/last-applied-configuration={"apiVersion":"v1","kind":"Service","metadata":{"annotations":{},"labels":{"addonmanager.kubernetes.io/mode":"Reconcile","k8s-app":"kube-dns","kubernet...
Selector:          k8s-app=kube-dns
Type:              ClusterIP
IP:                10.96.0.10
Port:              dns  53/UDP
TargetPort:        53/UDP
Endpoints:         172.17.0.12:53
Port:              dns-tcp  53/TCP
TargetPort:        53/TCP
Endpoints:         172.17.0.12:53
Session Affinity:  None
Events:            <none>
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl get pods
NAME                              READY     STATUS    RESTARTS   AGE
helloworld-dep-79fdc576b9-4rlhh   1/1       Running   0          34m
helloworld-dep-79fdc576b9-qrrj9   1/1       Running   0          34m
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl get pods -o wide
NAME                              READY     STATUS    RESTARTS   AGE       IP            NODE
helloworld-dep-79fdc576b9-4rlhh   1/1       Running   0          34m       172.17.0.9    minikube
helloworld-dep-79fdc576b9-qrrj9   1/1       Running   0          34m       172.17.0.13   minikube
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl get pods -n kube-system
NAME                                    READY     STATUS    RESTARTS   AGE
default-http-backend-cvzhd              1/1       Running   237        119d
heapster-546c9964c6-2w8ld               1/1       Running   63         119d
heapster-xnbjb                          1/1       Running   63         119d
influxdb-grafana-tx55c                  2/2       Running   129        119d
kube-addon-manager-minikube             1/1       Running   66         183d
kube-dns-54cccfbdf8-fm9cn               3/3       Running   33         27d
kubernetes-dashboard-77d8b98585-mftdb   1/1       Running   3          17d
metrics-server-bb9ffc6b8-c4bsh          1/1       Running   64         119d
monitoring-grafana-65757b9656-h4fbs     1/1       Running   62         119d
monitoring-influxdb-66946c9f58-h5lhw    1/1       Running   65         119d
nginx-ingress-controller-zjd74          1/1       Running   408        119d
tiller-deploy-5b7c59888b-6rbgl          1/1       Running   258        103d
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl get pods -n kube-system -o wide
NAME                                    READY     STATUS    RESTARTS   AGE       IP
  NODE
default-http-backend-cvzhd              1/1       Running   237        119d      172.17.0.4
  minikube
heapster-546c9964c6-2w8ld               1/1       Running   63         119d      172.17.0.7
  minikube
heapster-xnbjb                          1/1       Running   63         119d      172.17.0.3
  minikube
influxdb-grafana-tx55c                  2/2       Running   129        119d      172.17.0.2
  minikube
kube-addon-manager-minikube             1/1       Running   66         183d      192.168.99.137
  minikube
kube-dns-54cccfbdf8-fm9cn               3/3       Running   33         27d       172.17.0.12
  minikube
kubernetes-dashboard-77d8b98585-mftdb   1/1       Running   3          17d       172.17.0.14
  minikube
metrics-server-bb9ffc6b8-c4bsh          1/1       Running   64         119d      172.17.0.11
  minikube
monitoring-grafana-65757b9656-h4fbs     1/1       Running   62         119d      172.17.0.15
  minikube
monitoring-influxdb-66946c9f58-h5lhw    1/1       Running   65         119d      172.17.0.6
  minikube
nginx-ingress-controller-zjd74          1/1       Running   408        119d      172.17.0.5
  minikube
tiller-deploy-5b7c59888b-6rbgl          1/1       Running   258        103d      172.17.0.10
  minikube
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ #kube-dns-54cccfbdf8-fm9cn
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl get pods
NAME                              READY     STATUS    RESTARTS   AGE
helloworld-dep-79fdc576b9-4rlhh   1/1       Running   0          35m
helloworld-dep-79fdc576b9-qrrj9   1/1       Running   0          35m
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl get deploy -n kube-system
NAME                   DESIRED   CURRENT   UP-TO-DATE   AVAILABLE   AGE
heapster               1         1         1            1           181d
kube-dns               1         1         1            1           183d
kubernetes-dashboard   1         1         1            1           183d
metrics-server         1         1         1            1           181d
monitoring-grafana     1         1         1            1           181d
monitoring-influxdb    1         1         1            1           181d
tiller-deploy          1         1         1            1           103d
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ


--------------------------------------------------


Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl apply -f blog/blog-db.yml
deployment "blog-db-dep" created
service "blog-db-svc" created
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl get pods
NAME                           READY     STATUS    RESTARTS   AGE
blog-db-dep-654dfc76d9-rdfl4   1/1       Running   0          22s
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl get pods -o wide
NAME                           READY     STATUS    RESTARTS   AGE       IP           NODE
blog-db-dep-654dfc76d9-rdfl4   1/1       Running   0          29s       172.17.0.9   minikube
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl describe svc "blog-db-svc"
Name:              blog-db-svc
Namespace:         default
Labels:            <none>
Annotations:       kubectl.kubernetes.io/last-applied-configuration={"apiVersion":"v1","kind":"Service","metadata":{"annotations":{},"name":"blog-db-svc","namespace":"default"},"spec":{"ports":[{"port":8888,"protocol":"...
Selector:          app=blog-db
Type:              ClusterIP
IP:                10.99.207.110
Port:              <unset>  8888/TCP
TargetPort:        dbport/TCP
Endpoints:         172.17.0.9:3306
Session Affinity:  None
Events:            <none>
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl apply -f blog/blog-ghost.yml
service "blog-ghost-svc" created
Error from server (BadRequest): error when creating "blog/blog-ghost.yml": Deployment in version "v1beta1" cannot be handled as a Deployment: v1beta1.Deployment: Spec: v1beta1.DeploymentSpec: Template: v1.PodTemplateSpec: Spec: v1.PodSpec: Containers: []v1.Container: v1.Container: Env: []v1.EnvVar: v1.EnvVar: Value: ReadString: expects " or n, parsing 1413 ...,"value":8... at {"apiVersion":"extensions/v1beta1","kind":"Deployment","metadata":{"annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"extensions/v1beta1\",\"kind\":\"Deployment\",\"metadata\":{\"annotations\":{},\"name\":\"blog-ghost-dep\",\"namespace\":\"default\"},\"spec\":{\"replicas\":1,\"template\":{\"metadata\":{\"labels\":{\"app\":\"blog-ghost\"}},\"spec\":{\"containers\":[{\"env\":[{\"name\":\"database__client\",\"value\":\"mysql\"},{\"name\":\"database__connection__user\",\"value\":\"root\"},{\"name\":\"database__connection__password\",\"value\":\"welcome\"},{\"name\":\"database__connection__database\",\"value\":\"ghost\"},{\"name\":\"database__connection__host\",\"value\":\"blog-db-svc\"},{\"name\":\"database__connection__port\",\"value\":8888}],\"image\":\"ghost:1-alpine\",\"imagePullPolicy\":\"IfNotPresent\",\"name\":\"ghost\",\"ports\":[{\"containerPort\":2368,\"name\":\"ghostport\"}]}]}}}}\n"},"name":"blog-ghost-dep","namespace":"default"},"spec":{"replicas":1,"template":{"metadata":{"labels":{"app":"blog-ghost"}},"spec":{"containers":[{"env":[{"name":"database__client","value":"mysql"},{"name":"database__connection__user","value":"root"},{"name":"database__connection__password","value":"welcome"},{"name":"database__connection__database","value":"ghost"},{"name":"database__connection__host","value":"blog-db-svc"},{"name":"database__connection__port","value":8888}],"image":"ghost:1-alpine","imagePullPolicy":"IfNotPresent","name":"ghost","ports":[{"containerPort":2368,"name":"ghostport"}]}]}}}}
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl describe svc blog-ghost-svc
Name:                     blog-ghost-svc
Namespace:                default
Labels:                   <none>
Annotations:              kubectl.kubernetes.io/last-applied-configuration={"apiVersion":"v1","kind":"Service","metadata":{"annotations":{},"name":"blog-ghost-svc","namespace":"default"},"spec":{"ports":[{"nodePort":32023,"por...
Selector:                 app=blog-ghost
Type:                     NodePort
IP:                       10.97.40.44
Port:                     <unset>  8888/TCP
TargetPort:               ghostport/TCP
NodePort:                 <unset>  32023/TCP
Endpoints:                <none>
Session Affinity:         None
External Traffic Policy:  Cluster
Events:                   <none>
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl apply -f blog/blog-ghost.yml
deployment "blog-ghost-dep" created
service "blog-ghost-svc" unchanged
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl get pods
NAME                              READY     STATUS    RESTARTS   AGE
blog-db-dep-654dfc76d9-rdfl4      1/1       Running   0          14m
blog-ghost-dep-865f98fdf7-649zd   1/1       Running   0          16s
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl describe svc blog-ghost-svc
Name:                     blog-ghost-svc
Namespace:                default
Labels:                   <none>
Annotations:              kubectl.kubernetes.io/last-applied-configuration={"apiVersion":"v1","kind":"Service","metadata":{"annotations":{},"name":"blog-ghost-svc","namespace":"default"},"spec":{"ports":[{"nodePort":32023,"por...
Selector:                 app=blog-ghost
Type:                     NodePort
IP:                       10.97.40.44
Port:                     <unset>  8888/TCP
TargetPort:               ghostport/TCP
NodePort:                 <unset>  32023/TCP
Endpoints:                172.17.0.13:2368
Session Affinity:         None
External Traffic Policy:  Cluster
Events:                   <none>
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl get pods
NAME                              READY     STATUS    RESTARTS   AGE
blog-db-dep-654dfc76d9-rdfl4      1/1       Running   0          15m
blog-ghost-dep-865f98fdf7-649zd   1/1       Running   0          56s
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ kubectl exec -it blog-db-dep-654dfc76d9-rdfl4 -- mysql -uroot -pwelcome
mysql: [Warning] Using a password on the command line interface can be insecure.
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 34
Server version: 5.7.25 MySQL Community Server (GPL)

Copyright (c) 2000, 2019, Oracle and/or its affiliates. All rights reserved.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

mysql> show databases;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| ghost              |
| mysql              |
| performance_schema |
| sys                |
+--------------------+
5 rows in set (0.01 sec)

mysql> exit
Bye
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ minikube ip
192.168.99.137
Dell lap@Dell ~/docker-workshop/jun10/ora-jun10-dock-kube/k8s (master)
λ
